/**
 * id: lNBA
 * path: ./perf
 */

function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BizCommonPerf=void 0;var e=require("./dimension"),t=require("./timing"),n=require(".."),r=require("../utils");function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}var s,u,c,f,d,m,h,v,p,w=function(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n},g=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},b=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},y=["url","refer_url","spm_id","timestamp","fts","browser_resolution","ptype","business_name","level","event_name","event_content","extra_info","arg1","arg2","arg3"],O=function(e){var t,n,o,i=null!==(t=e.data)&&void 0!==t?t:{},a=i.businessName,l=i.eventName,s=i.level,u=i.extraInfo,c=i.arg1,f=i.arg2,d=i.arg3,m=b(i,["businessName","eventName","level","extraInfo","arg1","arg2","arg3"]);return{url:encodeURIComponent(window.location.href),refer_url:""===document.referrer?"":encodeURIComponent(document.referrer),spm_id:null!==(n=e.spmId)&&void 0!==n?n:"",timestamp:Date.now(),fts:(0,r.getCookie)("fts"),browser_resolution:"".concat(window.innerWidth,"x").concat(window.innerHeight),ptype:(0,r.isMobile)()?2:1,business_name:null!=a?a:"live-performance-track",level:null!=s?s:"log",event_name:null!==(o=null!=l?l:e.evtId)&&void 0!==o?o:"performanceTrack",event_content:null==e.data?"":JSON.stringify(m).replace(/"/g,"%22"),extra_info:null!=u?u:"",arg1:null!=c?c:"",arg2:null!=f?f:"",arg3:null!=d?d:""}},_=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i(this,e),s.add(this),u.set(this,"000967"),c.set(this,void 0),f.set(this,void 0),d.set(this,void 0),m.set(this,null),w(this,c,t,"f"),w(this,f,n,"f"),w(this,d,r,"f"),g(this,s,"m",h).call(this),g(this,s,"m",v).call(this)}return l(e,[{key:"custom",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;g(this,s,"m",v).call(this,o({},e,t),{delay:n},!0)}}]),e}();exports.BizCommonPerf=_,u=new WeakMap,c=new WeakMap,f=new WeakMap,d=new WeakMap,m=new WeakMap,s=new WeakSet,h=function(){null==g(this,m,"f")&&w(this,m,new n.Tracker(g(this,u,"f"),{spmId:g(this,c,"f"),formatter:function(e){var t=O(e),n=[];return y.forEach(function(e){n.push(t[e])}),n}}),"f")},v=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];null!=window.performance?"complete"===document.readyState?g(this,s,"m",p).call(this,t,n,r):window.addEventListener("load",function(){g(e,s,"m",p).call(e,t,n,r)}):console.error("window.performance is nonexistent")},p=function(){var n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a="number"==typeof o.delay?o.delay:"number"==typeof g(this,f,"f").delay?g(this,f,"f").delay:0,l=Object.assign(Object.assign(Object.assign(Object.assign({},i?{}:(0,t.getPerformanceTiming)()),(0,e.getDimension)()),g(this,d,"f")),r),s=function(e){var t;return null===(t=g(n,m,"f"))||void 0===t?void 0:t.event("performanceTrack",e,{sample:100,randDelay:0})};a<=0?s(l):setTimeout(function(){s(l)},a)};
}